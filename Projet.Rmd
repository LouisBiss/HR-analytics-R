---
title: "R Notebook"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

##Importe les données

```{r}

df_employee_survey_data <- read.csv('C://Users//louis//Documents//COURS EMSE//Année 5 - Ingé 3//ESME//R//Projet//archive//employee_survey_data.csv')
df_general_data<- read.csv('C://Users//louis//Documents//COURS EMSE//Année 5 - Ingé 3//ESME//R//Projet//archive//general_data.csv')
df_in_time<- read.csv('C://Users//louis//Documents//COURS EMSE//Année 5 - Ingé 3//ESME//R//Projet//archive//in_time.csv')
df_manager_survey_data<- read.csv('C://Users//louis//Documents//COURS EMSE//Année 5 - Ingé 3//ESME//R//Projet//archive//manager_survey_data.csv')
df_out_time<- read.csv('C://Users//louis//Documents//COURS EMSE//Année 5 - Ingé 3//ESME//R//Projet//archive//out_time.csv')
```

```{r}

head(df_employee_survey_data)

```
#Traitement des données 

##Vérifie s'il y a des valeurs manquantes 

#Premier dataframe : df_employee_survey_data

```{r}

colSums(is.na(df_employee_survey_data))


```
#Second dataframe : df_general_data
Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.
```{r}
colSums(is.na(df_general_data))

```
#Troisième : In_time & Out_time Dataframe

```{r}
#A cause de l'immense quantité de données présente on ne peut pas juste afficher les colonnes avec le nombre de Na. Cela serait ilisible. 

any(is.na(df_in_time))
any(is.na(df_out_time))
```
#Quatrième : df_manager_survey_data
When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
```{r}
colSums(is.na(df_manager_survey_data))
```
#Remplacement des données Manquantes par la Moyenne 
###Afin de ne pas fausser notre jeux de données en supprimant simplement les lignes incomplètes nous allons remplacer les Na par la moyenne. 
```{r}
#duplique le dataframe afin d'effectuer nos essaie 
df_test <- df_general_data
df_test$NumCompaniesWorked[is.na(df_test$NumCompaniesWorked)] <- mean(df_test$NumCompaniesWorked, na.rm = TRUE)
# na.rm =TRUE : retire les Na du calcul de la moyenne 
colSums(is.na(df_test))

```


```{r}
#Colonne NumCompaniesWorked
df_general_data$NumCompaniesWorked[is.na(df_general_data$NumCompaniesWorked)] <- mean(df_test$NumCompaniesWorked, na.rm = TRUE)

#Colonne TotalWorkingYears

df_general_data$TotalWorkingYears[is.na(df_general_data$TotalWorkingYears)] <- mean(df_test$TotalWorkingYears, na.rm = TRUE)

any(is.na(df_general_data))

```

```{r}

#Pas besoin de chercher à remplacer les Na dans les data_time car un Na signifie qu'ils ne sont pas venue.

#replace les dates manquantes par le Mode (valeure la plus fréquente)
#rdf <- rle(df_in_time$mode)
#df$mode <- na.locf(inverse.rle(rdf))

#calc_mode <- function(x){
  # List the distinct / unique values
  #distinct_values <- unique(x)
  # Count the occurrence of each distinct value
  #distinct_tabulate <- tabulate(match(x, distinct_values))
  # Return the value with the highest occurrence
  #distinct_values[which.max(distinct_tabulate)]
#}


#for (i in colnames(df_in_time)){
  #rdf <- rle(df_in_time$i)
  #df_in_time$i <- na.locf(calc_mode(i))
#}

#if (!require("tidyverse")) install.packages("tidyverse")

#df_in_time <-mutate(across(everything(), ~replace_na(.x, calc_mode(.x))))

```


The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
